<script type="text/discourse-plugin" version="0.8">
  function getRandomBanner() {
    var str = settings.rotate_banner;
    var banners = str.split('|');
    if (banners.length >0) {
      var num = Math.floor( Math.random() * banners.length);
      var img = banners[num];
      console.log(img); 
      return img;
    }
    return settings.banner_image;
  }

  api.createWidget("e4-banner", {
    tagName: "div",

    html() {
      return  h("img.banner-center", {src: getRandomBanner()})
    }
  });

 function isImage(url) {
    return /\.(jpg|jpeg|png|webp|avif|gif|svg)$/.test(url);
  }

  const h = require("virtual-dom").h; 
  var strName = settings.navbar_name;
  var strURL = settings.navbar_location;
  
  var names = strName.split('|');
  var url = strURL.split('|');

  function createNavbarElement(navName, navURL) {
      
    if (isImage(navName)){
      return h('li', 
        h("a", { href: navURL }, 
          h("img.e4-button-image", {src: navName})));
    }
    
    return h('li', h("a", { href: navURL }, navName));
    }
  
  api.createWidget("e4-navbar", {
    tagName: "div.e4-container.e4-button",

    html() {
      const contents = [];
      for (let i = 0; i < names.length; i++) {
        contents.push(createNavbarElement(names[i], url[i]))
      } 
      return contents;
    }
  });
</script>

<script type="text/x-handlebars" data-template-name="/connectors/below-site-header/banner">
  {{mount-widget widget="e4-banner"}}
  {{mount-widget widget="e4-navbar"}}
</script>

